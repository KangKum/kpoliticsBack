services:
  # 백엔드 웹 서비스
  - type: web
    name: kpolitics-backend
    env: node
    region: singapore
    plan: free
    buildCommand: npm install && npm run build
    startCommand: npm run start
    healthCheckPath: /api/governors/metropolitan

    # 환경 변수 (Render 대시보드에서 설정 필요)
    envVars:
      - key: NODE_ENV
        value: production
      - key: MONGODB_URI
        sync: false  # 보안상 대시보드에서 직접 입력
      - key: VITE_ASSEMBLY_API_KEY
        sync: false
      - key: VITE_API_BASE_URL
        value: https://open.assembly.go.kr/portal/openapi
      - key: ADMIN_PASSWORD
        sync: false
      - key: VITE_DATAGO_API_KEY
        sync: false
      - key: FRONTEND_URL
        sync: false  # Vercel 배포 후 설정
      # PORT는 Render가 자동으로 제공

# Render 배포 가이드:
# 1. Render 대시보드에서 New > Web Service 선택
# 2. GitHub 저장소 연결
# 3. 백엔드 디렉토리 선택 (kpoliticsBack)
# 4. 이 render.yaml 파일이 자동으로 인식됨
# 5. Environment Variables에서 민감 정보 입력:
#    - MONGODB_URI: MongoDB 연결 문자열
#    - VITE_ASSEMBLY_API_KEY: 국회 API 키
#    - ADMIN_PASSWORD: 관리자 비밀번호
#    - VITE_DATAGO_API_KEY: 공공데이터 API 키
#    - FRONTEND_URL: Vercel 도메인 (예: https://your-app.vercel.app)
# 6. Deploy 클릭
#
# 주의사항:
# - Free plan은 15분 비활동 시 sleep 모드 진입 (첫 요청 시 30초 정도 소요)
# - Puppeteer는 무료 플랜에서 지원됨 (Chromium 자동 설치)
# - 월 750시간 무료 (약 한 달 상시 운영 가능)
